{"remainingRequest":"C:\\Users\\59952\\Desktop\\KoalaSleep\\app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\59952\\Desktop\\KoalaSleep\\app\\src\\views\\search.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\59952\\Desktop\\KoalaSleep\\app\\src\\views\\search.vue","mtime":1595769521857},{"path":"C:\\Users\\59952\\Desktop\\KoalaSleep\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\59952\\Desktop\\KoalaSleep\\app\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\59952\\Desktop\\KoalaSleep\\app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\59952\\Desktop\\KoalaSleep\\app\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgcmVjb21tZW5kIGZyb20gIi4uL2NvbXBvbmVudHMvcmVjb21tZW5kL3JlY29tbWVuZCI7DQppbXBvcnQgVGl0bGUgZnJvbSAiLi4vY29tcG9uZW50cy90aXRsZS90aXRsZSI7DQppbXBvcnQgc29uZ3MgZnJvbSAiLi4vY29tcG9uZW50cy9zb25nL3NvbmciOw0KaW1wb3J0IFVzZWxlc3MgZnJvbSAiLi4vY29tcG9uZW50cy9Vc2VsZXNzL1VzZWxlc3MiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICB2YWx1ZTogIiIsDQogICAgICBob3Q6IFtdLA0KICAgICAgbGlzdDogW10sDQogICAgICBzaG93OiB0cnVlLA0KICAgICAgaGlzdG9yeUxpc3Q6IFtdLA0KICAgIH07DQogIH0sDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5heGlvcy5hbGwoW3RoaXMuZ2V0RGF0YSgiL3NlYXJjaC9ob3QiKV0pLnRoZW4oDQogICAgICB0aGlzLmF4aW9zLnNwcmVhZCgoaG90KSA9PiB7DQogICAgICAgIHRoaXMuaG90ID0gaG90LmRhdGEucmVzdWx0LmhvdHM7DQogICAgICB9KQ0KICAgICk7DQogICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJoaXN0b3J5IikgIT0gbnVsbCkgew0KICAgICAgdGhpcy5oaXN0b3J5TGlzdCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImhpc3RvcnkiKSk7DQogICAgfWVsc2V7DQogICAgICB0aGlzLmhpc3RvcnlMaXN0PVtdDQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZ2V0RGF0YSh1cmwpIHsNCiAgICAgIHJldHVybiB0aGlzLmF4aW9zLmdldCh1cmwpOw0KICAgIH0sDQogICAgaW5wdXQodmFsdWUpIHsNCiAgICAgIHRoaXMuc2hvdyA9IGZhbHNlOw0KICAgICAgdGhpcy5zZWFyY2hTdWFsdCh2YWx1ZSk7DQogICAgfSwNCiAgICBzZWFyY2hTdWFsdCh2YWx1ZSkgew0KICAgICAgdGhpcy5zaG93ID0gZmFsc2U7DQogICAgICBpZiAodmFsdWUpIHsNCiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlOw0KICAgICAgICB0aGlzLmF4aW9zLmdldCgiL3NlYXJjaD9rZXl3b3Jkcz0iICsgdmFsdWUpLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgIHRoaXMubGlzdCA9IHJlcy5kYXRhLnJlc3VsdC5zb25nczsNCiAgICAgICAgICB0aGlzLmhpc3RvcnkoKTsNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCiAgICBhcnRuYW1lKG9iaikgew0KICAgICAgbGV0IHN0ciA9ICIiOw0KICAgICAgb2JqLmFydGlzdHMuZm9yRWFjaCgoaXRlbSkgPT4gew0KICAgICAgICBzdHIgKz0gaXRlbS5uYW1lICsgIiAiOw0KICAgICAgfSk7DQogICAgICByZXR1cm4gc3RyOw0KICAgIH0sDQogICAgaGlzdG9yeSgpIHsNCiAgICAgIGlmICh0aGlzLnZhbHVlKSB7DQogICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiaGlzdG9yeSIpID09PSBudWxsKSB7DQogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImhpc3RvcnkiLCBKU09OLnN0cmluZ2lmeShbdGhpcy52YWx1ZV0pKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBsZXQgYXJyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiaGlzdG9yeSIpKTsNCiAgICAgICAgICBhcnIudW5zaGlmdCh0aGlzLnZhbHVlKTsNCiAgICAgICAgICBjb25zdCBzZXQgPSBuZXcgU2V0KGFycik7DQogICAgICAgICAgdGhpcy5oaXN0b3J5TGlzdCA9IEFycmF5LmZyb20oc2V0KTsNCiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiaGlzdG9yeSIsIEpTT04uc3RyaW5naWZ5KEFycmF5LmZyb20oc2V0KSkpOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICBkZWxlY3Qoc3RyKSB7DQogICAgICB0aGlzLmhpc3RvcnlMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7DQogICAgICAgIGlmIChpdGVtID09PSBzdHIpIHsNCiAgICAgICAgICB0aGlzLmhpc3RvcnlMaXN0LnNwbGljZShpbmRleCwgMSk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImhpc3RvcnkiLCBKU09OLnN0cmluZ2lmeSh0aGlzLmhpc3RvcnlMaXN0KSk7DQogICAgICB0aGlzLmhpc3RvcnkoKTsNCiAgICB9LA0KICB9LA0KICBjb21wb25lbnRzOiB7DQogICAgcmVjb21tZW5kLA0KICAgIFRpdGxlLA0KICAgIHNvbmdzLA0KICAgIFVzZWxlc3MsDQogIH0sDQp9Ow0K"},{"version":3,"sources":["search.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"search.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div>\r\n    <van-search\r\n      v-model=\"value\"\r\n      placeholder=\"请输入搜索关键词\"\r\n      @input=\"show=true\"\r\n      @search=\"input\"\r\n      input-align=\"center\"\r\n    />\r\n    <div v-show=\"show\">\r\n      <Title title=\"热门搜索\"></Title>\r\n      <recommend>\r\n        <span\r\n          v-for=\"(item,index) in hot\"\r\n          :key=\"index\"\r\n          @click=\"searchSualt(item.first)\"\r\n        >{{item.first}}</span>\r\n      </recommend>\r\n      <Title title=\"历史搜索\"></Title>\r\n      <van-cell :title=\"item\" v-for=\"(item,index) in historyList\" :key=\"index\">\r\n        <template #right-icon>\r\n          <i class=\"iconfont icon-guanbi\" @click=\"delect(item)\"></i>\r\n        </template>\r\n      </van-cell>\r\n      <Useless v-if=\"historyList.length===0\"></Useless>\r\n    </div>\r\n    <div class=\"result\" v-show=\"!show\">\r\n      <songs\r\n        v-for=\"item in list\"\r\n        :key=\"item.id\"\r\n        :title=\"item.name\"\r\n        :name=\"artname(item)\"\r\n        :id=\"item.id\"\r\n      ></songs>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport recommend from \"../components/recommend/recommend\";\r\nimport Title from \"../components/title/title\";\r\nimport songs from \"../components/song/song\";\r\nimport Useless from \"../components/Useless/Useless\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      value: \"\",\r\n      hot: [],\r\n      list: [],\r\n      show: true,\r\n      historyList: [],\r\n    };\r\n  },\r\n  created() {\r\n    this.axios.all([this.getData(\"/search/hot\")]).then(\r\n      this.axios.spread((hot) => {\r\n        this.hot = hot.data.result.hots;\r\n      })\r\n    );\r\n    if (localStorage.getItem(\"history\") != null) {\r\n      this.historyList = JSON.parse(localStorage.getItem(\"history\"));\r\n    }else{\r\n      this.historyList=[]\r\n    }\r\n  },\r\n  methods: {\r\n    getData(url) {\r\n      return this.axios.get(url);\r\n    },\r\n    input(value) {\r\n      this.show = false;\r\n      this.searchSualt(value);\r\n    },\r\n    searchSualt(value) {\r\n      this.show = false;\r\n      if (value) {\r\n        this.value = value;\r\n        this.axios.get(\"/search?keywords=\" + value).then((res) => {\r\n          this.list = res.data.result.songs;\r\n          this.history();\r\n        });\r\n      }\r\n    },\r\n    artname(obj) {\r\n      let str = \"\";\r\n      obj.artists.forEach((item) => {\r\n        str += item.name + \" \";\r\n      });\r\n      return str;\r\n    },\r\n    history() {\r\n      if (this.value) {\r\n        if (localStorage.getItem(\"history\") === null) {\r\n          localStorage.setItem(\"history\", JSON.stringify([this.value]));\r\n        } else {\r\n          let arr = JSON.parse(localStorage.getItem(\"history\"));\r\n          arr.unshift(this.value);\r\n          const set = new Set(arr);\r\n          this.historyList = Array.from(set);\r\n          localStorage.setItem(\"history\", JSON.stringify(Array.from(set)));\r\n        }\r\n      }\r\n    },\r\n    delect(str) {\r\n      this.historyList.forEach((item, index) => {\r\n        if (item === str) {\r\n          this.historyList.splice(index, 1);\r\n        }\r\n      });\r\n      localStorage.setItem(\"history\", JSON.stringify(this.historyList));\r\n      this.history();\r\n    },\r\n  },\r\n  components: {\r\n    recommend,\r\n    Title,\r\n    songs,\r\n    Useless,\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n</style>"]}]}